# Computer Networking Midterm Project

By Yijian Liu (yjl450), Leyi Sun (ls4571)

# Launch

    $ python backend/server.py

This will launch the server and hosting the pre-built frontend files. The server requires dependencies: Flask, Flask-Socketio, which can be installed by running

    $ pip install flask flask-socketio

# Project Structure

# Communication Format
update: "action" field is changed to the event name of SocketIO and Flask-SocketIO

"groupid" is changed to room


## Create new user (login)
client: send 
    
    {"action": "login", "username": *username*}

server: reply 
    
    {"action":"login-response", "result": *success or other error*, "userid": *userid*, "username": *username*}

userid is generated by the server and the last digit is 0

## Update contact list

Server: send event: "contact"

    {"person": {
        *userid*:{*userid*: *username*}
        },
    "group": {
        *groupid*: {*userid*: *username*}
        }  
    }

## Send message to group
Client: send 
    
    {"action": "message", "sender": *userid*, "receiver": *groupid*, "message": *content*}

Server: forward the message to all members of the group (excluding sender) 
    
    {"action": "message", "sender": *userid*, "receiver": *groupid*, "message": *content*}

## Create Group
client: send

    {"action": "create_group", 
     "sender": *userid*, 
     "member":{*userid*: *username*}} // including sender
Server: 

broadcast to all member in this group 
    
    {"action": "new_group", "groupid": groupid, "member":{*userid*: *username*} }

then update contact list 

## Join Group
client: send 

    {"action": "join_group", "groupid": *groupid*, "sender": *userid*}
Server: 

broadcast to all member in this group 

    {"action": "new_group", "groupid": groupid, "member":{*userid*: *username*} }

then update contact list

## Leave Group
client: send 

    {"action": "leave_group", "groupid": *groupid*, "sender": *userid*}
Server: remove user from group. If there is only one user in the group, delete the group, then update contact list

## Logout
client: send

    {"action": "logout", "sender": *userid*}

Server: delete current user from all possible groups, delete user from person list, update contact list

